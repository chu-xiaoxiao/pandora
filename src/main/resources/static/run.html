<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
<div id="app">
    <el-form  label-width="80px" :model="startRequestParam">
        <el-form-item label="项目地址">
            <el-input v-model="startRequestParam.url"></el-input>
        </el-form-item>
        <el-form-item label="分支">
            <el-input v-model="startRequestParam.branch"></el-input>
        </el-form-item>
        <el-form-item label="应用">
            <el-input v-model="startRequestParam.project"></el-input>
        </el-form-item>
        <el-button type="primary" @click="deploy">发布</el-button>
    </el-form>
    <div v-html = "log"></div>
</div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script>
    var doit = new Vue({
        el: "#app",
        data: {
            startRequestParam:{
                url:null,
                branch:null,
                project:null
            },
            log:null,
        },
        methods: {
            success(successMessage, duration) {
                if (successMessage) {
                    this.$message({
                        showClose: true,
                        message: successMessage,
                        type: 'success',
                        duration: duration || 3 * 1000
                    })
                }
            },
            fail(failMessage) {
                if (failMessage) {
                    this.$message({
                        showClose: true,
                        message: failMessage,
                        type: 'warning'
                    })
                }
            },
            deploy:function(){
                var that = this;
                axios.post('/deploy', this.startRequestParam)
                    .then(function c(response) {
                        console.log(response);
                        that.log = response.data;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            }
        }
    });
</script>
</html>